# Fail2ban filter for Sanal Mülakatım
# Targets noisy bot scans and repeated 401/403/429 responses.
#
# Caddy JSON access log example fields we use:
#   "request":{"remote_ip":"1.2.3.4", ...}
#   "status":403
#
# Tested against: Caddy log {format json}

[Definition]

failregex = ^.*"remote_ip"\s*:\s*"<HOST>".*"status"\s*:\s*(401|403|429)\b.*$
            ^.*"client_ip"\s*:\s*"<HOST>".*"status"\s*:\s*(401|403|429)\b.*$

ignoreregex =
